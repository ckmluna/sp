<?php  session_start();  $allowedExts = array("txt");  $temp = explode(".", $_FILES["file"]["name"]);  $extension = end($temp);  if ($_FILES["file"]["type"] == "text/plain" && in_array($extension, $allowedExts))  {    if ($_FILES["file"]["error"] > 0)    {      echo "Return Code: " . $_FILES["file"]["error"] . "<br>";    }    else    {      move_uploaded_file($_FILES["file"]["tmp_name"],"upload/cl.txt");      $row = 1;      if (($handle = fopen("upload/cl.txt", "r")) !== FALSE)      {        while (($data = fgetcsv($handle, 1000, ",")) !== FALSE)        {          $num = count($data);          $row++;          echo $data[0] . ", A.Y. " . $data[1] . "<br>";          echo "            <table class=\"course-offering\">              <thead><tr>                <th>Course Code</th>                <th>Title</th>                <th>Description</th>                <th>Unit</th>                <th>Semester/s Offered</th>                <th>Prerequisites</th>              </tr></thead>";          for ($c=2; $c < $num; $c++)          {            $conn = pg_connect("host=localhost port=5432 dbname=postgres user=postgres password=password")or die("Could not connect to server!\n");            $sql = pg_query($conn, "SELECT * FROM course WHERE course_code = '".$data[$c]."'")or die("Query failed with error: ".pg_last_error($conn));            $row = pg_fetch_array($sql);            echo "              <tr>                <td>".$row['course_code']."</td>                <td>".$row['course_title']."</td>                <td>".$row['course_description']."</td>                <td>".$row['units']."</td>                <td>".$row['sem']."</td>                <td>Prerequisites</td>              </tr>";          }          echo "          </table>";        }        fclose($handle);      }      header('Location: uploadclasslist.php?uploaded');    }  }  else  {    header('Location: uploadclasslist.php?invalid');  }?>